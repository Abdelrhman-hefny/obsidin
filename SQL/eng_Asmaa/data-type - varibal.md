
##  أولاً: المتغيرات -  الفرق بين **متغير Global** و **Local**؟

###  Local Variable

- متغير بيتعرف **جوا بلوك معين** (زي دالة أو إجراء) - وميقدرش أي كود بره البلوك يشوفه أو يستخدمه.
    حاجه خاصه بيك بتعملها تخزن فيها بينانات بدل متكررها اكتر من مره .

```sql
DECLARE @name VARCHAR(50);  -- Local
SET @name = 'Ahmed';
PRINT @name;
```

###  Global Variable

- في SQL Server، مفيش "Global" متغيرات بتتعرفها بنفسك، لكن فيه **متغيرات خاصه بالنظام Global** بتبدأ بـ `@@`، زي:

```sql
SELECT @@VERSION;  -- بيطبع إصدار SQL Server
```

---


###  **ثانيا: أنواع البيانات الرقمية (Numbers)**

|النوع|الوصف|المدى|الحجم في الذاكرة|متى تستخدمه؟|
|---|---|---|---|---|
|`tinyint`|عدد صحيح صغير جدًا|0 إلى 255|1 بايت|لو قيمة محدودة (زي الحالات 0 أو 1)|
|`smallint`|عدد صحيح صغير|-32,768 إلى 32,767|2 بايت|عدد ساعات - عدد أيام - كميات صغيرة|
|`int`|عدد صحيح شائع الاستخدام|-2,147,483,648 إلى 2,147,483,647|4 بايت|أرقام عادية - ID - عداد|
|`bigint`|عدد كبير جدًا|-9 كوادريليون إلى +9 كوادريليون|8 بايت|عداد مشاهدات - أرقام ضخمة|
|`decimal(p,s)` / `numeric(p,s)`|عدد عشري بدقة عالية|حسب الـ precision والـ scale|من 5 لـ 17 بايت|أسعار - حسابات دقيقة|
|`float`|عدد عشري تقريبي (دقة 15 رقم)|~1.79E+308|4 أو 8 بايت|إحصائيات - نسب - مش بالدقة القصوى|
|`real`|عدد عشري تقريبي (دقة 7 أرقام)|~3.4E+38|4 بايت|زي float بس أخف|

---

###  **أنواع النصوص (Strings)**

|النوع|الوصف|يدعم عربي؟|الحجم في الذاكرة|متى تستخدمه؟|
|---|---|---|---|---|
|`char(n)`|نص بطول ثابت|❌|n بايت|كود ثابت مثل كود الدولة أو رقم مكون من 10 أرقام|
|`varchar(n)`|نص بطول متغير|❌|عدد الحروف المستخدمة فقط|أسماء - عناوين - أي نص غير عربي|
|`nvarchar(n)`|نص بطول متغير يدعم Unicode|✅|عدد الحروف × 2 بايت|أسماء بالعربي - بيانات بلغات متعددة|

---

###  **أنواع التاريخ والوقت (Date & Time)**

|النوع|الوصف|يحتوي على وقت؟|الحجم في الذاكرة|متى تستخدمه؟|
|---|---|---|---|---|
|`date`|تاريخ فقط|❌|3 بايت|تاريخ الميلاد - مواعيد بدون توقيت|
|`datetime`|تاريخ + وقت|✅|8 بايت|الحجز - الطباعة - سجل العمليات|
|`datetime2`|نفس datetime بدقة أعلى|✅|6 - 8 بايت|الأفضل غالبًا بدل datetime|

---

###  **أنواع أخرى مهمة**

|النوع|الوصف|الحجم|متى تستخدمه؟|
|---|---|---|---|
|`bit`|0 أو 1 فقط|1 بت|فلاج: مفعل أو لا - صح أو خطأ|
|`uniqueidentifier`|معرف فريد عالمي (GUID)|16 بايت|IDs لازم تكون مميزة عالميًا|

---

### ليه مهم نحدد أنواع البيانات في SQL؟


-  **بتوضح نوع البيانات** (رقم؟ تاريخ؟ نص؟)
    
-  **بتحميك من الأخطاء** (مينفعش تدخل "نص" بدل "رقم")
    
-  **بتوفر مساحة** (كل نوع بياخد حجم معين)
    
-  **بتسهّل الصيانة** (لو عايز تغيّر أو تتحقق من البيانات)
- 
مثال:
```sql
CREATE TYPE PhoneNumber FROM VARCHAR(11) NOT NULL;
```

لفهم أنواع البيانات في SQL Server بشكل أعمق :
https://www.sqlservertutorial.net/sql-server-basics/sql-server-data-types/
---

#  ثالثا: أنواع أوامر SQL الرئيسية

الـ SQL بتنقسم لـ **5 أنواع رئيسية من الأوامر**، كل نوع ليه وظيفة محددة:

---

## 1️⃣ DDL - Data Definition Language (لغة تعريف البيانات)


هي أوامر بتستخدم علشان **تجهز شكل وهيكل الجدول أو قاعدة البيانات**، يعني تنشئ أو تعدل أو تحذف جدول.


|الأمر|وظيفته|
|---|---|
|`CREATE TABLE`|ينشئ جدول جديد|
|`ALTER TABLE`|يعدل على جدول موجود (إضافة/حذف عمود)|
|`DROP TABLE`|يحذف الجدول بالكامل|
|`CREATE VIEW / FUNCTION`|تنشئ View أو دالة في SQL|
|`SELECT INTO`|تنسخ بيانات من جدول لآخر بجداول جديدة|

###  مثال:

```sql
CREATE TABLE Employees (
    ID INT PRIMARY KEY,
    Name NVARCHAR(100),
    Age INT
);
```

>  ال DDL كأنك بتبني **الإطار الخارجي** للبيت (الجداول، الأعمدة).

---

## 2️⃣ DML - Data Manipulation Language (لغة معالجة البيانات)

أوامر بتحكم في البيانات نفسها (إضافة - تعديل - حذف).


|الأمر|وظيفته|
|---|---|
|`INSERT`|يضيف بيانات للجدول|
|`UPDATE`|يعدل بيانات موجودة|
|`DELETE`|يحذف بيانات|
|`MERGE`|يدمج بيانات من جدول لآخر|

###  مثال:

```sql
INSERT INTO Employees VALUES (1, N'أحمد', 30);
UPDATE Employees SET Age = 31 WHERE ID = 1;
DELETE FROM Employees WHERE ID = 1;
```

>  فكر فيها كأنك بتكتب أو بتمسح من ورقة بيانات (الجدول).

---

## 3️⃣ DCL - Data Control Language (لغة التحكم في الصلاحيات)


أوامر للتحكم في من يقدر **يشوف أو يعدل البيانات**.

|الأمر|وظيفته|
|---|---|
|`GRANT`|يعطي صلاحية للمستخدم|
|`REVOKE`|يسحب صلاحية من المستخدم|
|`DENY`|يمنع صلاحية معينة|

مثال:

```sql
GRANT SELECT ON Employees TO user1;
REVOKE SELECT ON Employees FROM user1;
```

>  كأنك بتدي **مفتاح** لحد علشان يدخل المكتب (الجدول)، أو بتسحب منه المفتاح.

---

## 4️⃣ DQL - Data Query Language (لغة الاستعلام عن البيانات)

أوامر لاسترجاع البيانات من قاعدة البيانات.

| الأمر                 | وظيفته                       |
| --------------------- | ---------------------------- |
| `SELECT`              | يعرض بيانات                  |
| `GROUP BY`            | يجمع بيانات حسب عمود معين    |
| `UNION`               | يدمج نتايج استعلامين         |
| `JOIN`                | يربط جدولين ببعض             |
| `SUBQUERY`            | استعلام داخل استعلام         |
| `Aggregate Functions` | زي `COUNT`, `SUM`, `AVG` إلخ |

 مثال:

```sql
SELECT Name, Age FROM Employees WHERE Age > 25;
```

>  "هاتلي الموظفين اللي سنهم أكبر من 25".

---

## 5️⃣ TCL - Transaction Control Language (لغة التحكم في المعاملات)

تتحكم في تنفيذ العمليات مع بعض، لو حصل خطأ **ترجع كل حاجة زي ما كانت**.

|الأمر|وظيفته|
|---|---|
|`BEGIN TRANSACTION`|تبدأ عملية جديدة|
|`COMMIT`|تنفذ العملية وتحفظ التغييرات|
|`ROLLBACK`|تلغي كل التعديلات اللي حصلت|

 مثال:

```sql
BEGIN TRANSACTION;
UPDATE Employees SET Age = Age + 1;
-- لو حصل خطأ:
ROLLBACK;
-- لو كل حاجة تمام:
COMMIT;
```

>   "إما أعدي العملية كلها أو ألغي كل حاجة".

---

# ثالثا ERD: 

اولا: **ال ERD** اختصار لـ:  **Entity Relationship Diagram**  - مخطط الكيانات والعلاقات
يعني: **رسم العلاقات بين الجداول**
###  الغرض منه:

- **توضيح شكل قاعدة البيانات قبل ما تتبني**
- **تحديد الجداول والحقول والعلاقات بينها**
- **يساعد في الفهم، التصميم، والتطوير بدون أخطاء**
- **يقلل التكرار ويسهّل تعديل البيانات في المستقبل**

---

##  ثانياً: مكونات ERD والأشكال الأساسية في ERD 

| العنصر                   | الشكل المستخدم              | الشرح                                                 |
| ------------------------ | --------------------------- | ----------------------------------------------------- |
| **Entity (كيان)**        | 🟥 **مربع**                 | يمثل جدول (زي: طالب – منتج – موظف)                    |
| **Attribute (خاصية)**    | 🟠 **بيضاوي (أو دائرة)**    | العمود داخل الجدول (زي: الاسم – العمر)                |
| **Primary Key**          | 🟠 **بيضاوي وتحته خط**      | خاصية تميز كل سجل – المفتاح الأساسي في الجدول         |
| **Relationship (علاقة)** | 🔷 **معين (أو شكل المعين)** | يوضح العلاقة بين جدولين (زي: يسجل – يمتلك – يشارك في) |
ال**Foreign Key** غالبًا بيظهر كسهم بين الكيانات|يربط جدول بجدول تاني – مع توضيح نوع العلاقة (1:1 أو 1:N)

---

## ثالثا: أنواع العلاقات في ERD:
### 1. One to One (1:1)

كل سجل في الجدول الأول يقابله سجل واحد في الجدول الثاني.
**مثال:** موظف واحد له بطاقة واحدة فقط، وكل بطاقة تخص موظف واحد.

### 2. One to Many (1:N)

كل سجل في الجدول الأول يقابله عدة سجلات في الجدول الثاني.
**مثال:** قسم واحد يحتوي على عدة موظفين، لكن كل موظف ينتمي لقسم واحد فقط.

### 3. Many to Many (M:N)

كل سجل في الجدول الأول يقابله عدة سجلات في الجدول الثاني، والعكس.
**مثال:** الطالب يمكن أن يسجل في أكثر من دورة، والدورة الواحدة يمكن أن تضم أكثر من طالب.  
(يتم حلها باستخدام جدول وسيط)

---
## رابعا: خطوات إنشاء ERD:

1. **تحديد الجداول الرئيسية** (مثل: طالب، دورة، موظف).
    
2. **تحديد الأعمدة** داخل كل جدول، وتحديد المفتاح الأساسي.
    
3. **تحديد العلاقات** بين الجداول (1:1 أو 1:N أو N:N).
    
4. في حالة العلاقة Many to Many، يتم إنشاء جدول وسيط.
    
5. استخدام أدوات رسم مثل: draw.io أو DBDiagram.io أو SSMS.


![[{C81D549F-3827-4442-B1E8-D2DE666DDCBA}.png]]


---

# انشاء قاعده البيانات:

```sql  
CREATE DATABASE CompanyG06; 
```

- `CREATE DATABASE` → أمر الإنشاء.
- `CompanyG06` → اسم قاعدة البيانات (اختاره على حسب المشروع).

---
اختيار قاعده البيانات لبدا كتابه الاكواد :

```sql
USE CompanyG06;
GO
```
* `USE` بتحدد قاعدة البيانات.
* `GO` معناها نفّذ الأمر اللي فوقها قبل ما تكمل باقي الكود.

أكيد، إليك شرح **إنشاء الجداول في SQL Server** بأسلوب سهل ومختصر:

---
## إنشاء جدول في SQL:


```sql
CREATE TABLE اسم_الجدول (
    اسم_العمود نوع_البيانات شروط_اختيارية
);
```

1. **تحدد اسم الجدول**
2. **تكتب الأعمدة** (الاسم + نوع البيانات)
3. **تحدد المفتاح الأساسي** لو فيه
4. ممكن تضيف شروط زي `NOT NULL` أو `DEFAULT`

----
## مثال: انشاء جدول الموظفين | Employees

```sql
CREATE TABLE Employees (
    SSN INT PRIMARY KEY IDENTITY(1,1),
    Fname VARCHAR(15) NOT NULL,
    Lname VARCHAR(15),
    Gender CHAR(1),
    BirthDate DATE,
    Dnum INT,
    Super_SSN INT REFERENCES Employees(SSN)
);
```

من المخطط، جدول ال**Employees** يحتوي على الأعمدة التالية:

| العمود      | الغرض                                   |
| ----------- | --------------------------------------- |
| `SSN`       | رقم الموظف (مفتاح أساسي + ترقيم تلقائي) |
| `Fname`     | الاسم الأول (إجباري)                    |
| `Lname`     | الاسم الأخير (اختياري)                  |
| `Gender`    | النوع (M أو F)                          |
| `BirthDate` | تاريخ الميلاد                           |
| `Dnum`      | رقم القسم (هنربطه لاحقًا بجدول الأقسام) |
| `Super_SSN` | رقم المدير (يرجع لموظف آخر بنفس الجدول) |
### ملاحظات:


- `IDENTITY(1,1)` معناها: يبدأ الترقيم التلقائي من 1 ويزيد بـ 1.
- `Super_SSN` بيربط الموظف بمديره → علاقة **Self-Reference**.
- `Dnum` بيربط الموظف بقسمه، وده هنضيف له علاقة خارجية بعد ما ننشئ جدول الأقسام `Departments`.

---

## إنشاء جدول `Departments`

```sql
CREATE TABLE Departments (
    Dnum INT PRIMARY KEY IDENTITY(10,10),
    Dname VARCHAR(20) NOT NULL,
    Manager_SSN INT NOT NULL UNIQUE REFERENCES Employees(SSN),
    HiringDate DATE
);
```

### ملاحظات :

- `Manager_SSN` بيربط القسم بالموظف اللي بيديره.
- `UNIQUE` لأن القسم له مدير واحد فقط.
- `REFERENCES Employees(SSN)` عشان نربطه بالموظفين.

---


## إنشاء جدول `Projects`

```sql
CREATE TABLE Projects (
    Pnum INT PRIMARY KEY IDENTITY(100,1),
    Pname VARCHAR(30) NOT NULL,
    Location VARCHAR(30),
    City VARCHAR(30),
    Dnum INT NOT NULL REFERENCES Departments(Dnum)
);
```


---

## إنشاء جدول `Works_On` (علاقة الموظفين بالمشاريع)

```sql
CREATE TABLE Works_On (
    SSN INT,
    Pnum INT,
    Num_Of_Hours INT CHECK (Num_Of_Hours >= 0),
    PRIMARY KEY (SSN, Pnum),
    FOREIGN KEY (SSN) REFERENCES Employees(SSN),
    FOREIGN KEY (Pnum) REFERENCES Projects(Pnum)
);
```

- `Num_Of_Hours` لتسجيل عدد الساعات التي عملها الموظف على مشروع معين.


---

## إنشاء جدول `Dependents`

```sql
CREATE TABLE Dependents (
    Dep_ID INT PRIMARY KEY IDENTITY(1,1),
    SSN INT NOT NULL REFERENCES Employees(SSN),
    Name VARCHAR(20) NOT NULL,
    Gender CHAR(1),
    BirthDate DATE
);
```


---

### ربط الموظف بالقسم (من جدول Employees → Departments)

```sql
ALTER TABLE Employees
ADD CONSTRAINT FK_Employee_Department
FOREIGN KEY (Dnum) REFERENCES Departments(Dnum);
```

---
### علاقة الإشراف الذاتي بين الموظفين

```sql
ALTER TABLE Employees
ADD CONSTRAINT FK_Employee_Supervisor
FOREIGN KEY (Super_SSN) REFERENCES Employees(SSN);
```

---

## الفرق بين Primary Key و Foreign Key :

| المقارنة          | **Primary Key (مفتاح أساسي)**        | **Foreign Key (مفتاح خارجي)**                              |
| ----------------- | ------------------------------------ | ---------------------------------------------------------- |
| الغرض             | يميّز كل صف في الجدول                | يربط الجدول بجدول تاني                                     |
| التكرار           | لا يمكن التكرار                      | ممكن يتكرر                                                 |
| القيم الفارغة     | غير مسموح بـ NULL                    | ممكن يكون NULL (حسب التصميم)                               |
| العلاقة بالجداول  | موجود داخل الجدول نفسه               | يشير إلى **Primary Key** في جدول تاني                      |
| مثال              | SSN (رقم الموظف) في جدول `Employees` | Dnum (رقم القسم) في جدول `Employees` يشير لـ `Departments` |
|  الخصائص الإضافية | UNIQUE + NOT NULL                    | FOREIGN KEY + REFERENCES                                   |

---
___

##  **إزاي تدخل بيانات (INSERT)** في الجداول اللي أنشأناها، 


امر INSERT - هو أمر بنستخدمه في SQL علشان "ندخل بيانات" جوه جدول فاضي أو نضيف صف جديد في جدول موجود بالفعل.

##  **شكل جملة INSERT:**

```sql
INSERT INTO اسم_الجدول (العمود1، العمود2، ...)
VALUES (القيمة1، القيمة2، ...);
```

ببساطة:  يعني "ضيفلي البيانات دي في الأعمدة دي".

---

## مثال: ندخل موظف جديد

عندنا جدول `Employees`، وعايزين نضيف موظف اسمه "أحمد علي":

```sql
INSERT INTO Employees (Fname, Lname, Gender, BirthDate, Dnum, Super_SSN)
VALUES ('Ahmed', 'Ali', 'M', '1990-05-10', 10, NULL);
```


- `Employees`: اسم الجدول
- `(Fname, Lname, ...)`: الأعمدة اللي هتمليها
- `VALUES (...)`: القيم اللي هتتحط في نفس الترتيب
- `NULL`: معناها "مفيش قيمة" (مثلاً المدير غير معروف)

---
##  **ملاحظات :**

|المعلومة|معناها|
|---|---|
|لو فيه عمود بيزيد تلقائي (`IDENTITY`)|متكتبوش في الـ INSERT، زي `SSN`|
|لازم ترتيب القيم يمشي مع ترتيب الأعمدة|ماينفعش تبدّلهم|
|الأعمدة اللي مكتوب عليها `NOT NULL`|لازم تملاها|
|الأعمدة المرتبطة بجدول تاني|لازم تدخل قيمة موجودة فعلًا هناك|

---

## 2. جدول `Departments`

```sql
INSERT INTO Departments (Dname, Manager_SSN, HiringDate)
VALUES 
('IT', 1, '2020-01-01'),
('HR', 3, '2021-06-15');
```

---

## 3. جدول `Projects`

```sql
INSERT INTO Projects (Pname, Location, Dnum)
VALUES 
('Website Redesign', 'Cairo', 10),
('HR System', 'Alex', 20);
```

---

## 4. جدول `Dependents`

```sql
INSERT INTO Dependents (DependentName, Gender, BirthDate, ESSN)
VALUES 
('Laila', 'F', '2012-04-01', 1),
('Omar', 'M', '2015-07-10', 2);
```

---

## 5. جدول `Works_On` (العلاقة بين الموظفين والمشاريع)

```sql
INSERT INTO Works_On (ESSN, Pnum, Num_Of_Hours)
VALUES 
(1, 100, 20.5),
(2, 100, 15.0),
(2, 101, 10.0),
(3, 101, 18.5);
```

> ملاحظة: تأكد إن الأرقام المستخدمة في `SSN` و `Pnum` موجودة فعلًا من البيانات اللي دخلتها قبل كده.



tutorial: 
https://www.sqlservertutorial.net/sql-server-basics/