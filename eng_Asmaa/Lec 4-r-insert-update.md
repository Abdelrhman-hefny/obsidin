Lec 4-r-ALTER-drob- insert-update
##  1- امر `ALTER TABLE` — تعديل هيكل الجدول (DDL)

أمر بنستخدمه لما نحب **نغير شكل الجدول** نفسه، مش البيانات اللي جواه. التغييرات دي ممكن تكون:

1. تضيف عمود جديد.
2. تغيّر اسم عمود.
3. تغيّر نوع بيانات عمود.
4. تحذف عمود من الجدول.

---
##  أولًا: **إضافة عمود جديد**

ممكن تبدأ بجدول فيه بيانات معينة، وبعدين تكتشف إنك محتاج تخزن معلومة إضافية مش موجودة.

مثال:سس
```sql
ALTER TABLE Employees
ADD Department varchar(50);
```


- `ALTER TABLE Employees`: بنعدل على جدول اسمه `Employees`.
    
- `ADD Department varchar(50)`: بنضيف عمود جديد اسمه `Department`، ونوعه **نص (حروف)** لحد 50 حرف.

---

##  ثانيًا: **تغيير نوع بيانات عمود موجود**

لأنك ممكن تكون حددت نوع بيانات **صغير أو غير مناسب**، وبعدين احتجت:

- تدخّل بيانات أكبر.    - تدعّم العربي.     - تقبل أرقام عشرية بدل صحيحة.

مثال:
```sql
ALTER TABLE Employees
ALTER COLUMN Department nvarchar(100);
```


ا   ALTER TABLE Employees بنعدل على نفس الجدول Employees.

ا   ALTER COLUMN Department بنغير خصائص عمود موجود اسمه Department.

ا   nvarchar(100) النوع الجديد للعمود: نص بيقبل اللغة العربية ولحد 100 حرف.

---
💡 **الفرق بين `varchar` و `nvarchar`:**

|`varchar`|`nvarchar`|
|---|---|
|يدعم الإنجليزي فقط أو لغات ANSI|يدعم العربي وجميع اللغات|
|خفيف في التخزين|أثقل شوية لأنه Unicode|

---

##  ثالثًا: **تغيير اسم عمود موجود**

ممكن الاسم يكون:      - مش واضح.      - فيه خطأ إملائي.      - طويل زيادة عن اللزوم.

###  تغيير اسم جدول:

```sql
EXEC sp_rename 'OldTableName', 'NewTableName';
```

مثال:
```sql
EXEC sp_rename 'emp', 'Employees';
```

---
###  تغيير اسم عمود:

```sql
EXEC sp_rename 'TableName.OldColumnName', 'NewColumnName', 'COLUMN';
```

مثال:
```sql
EXEC sp_rename 'Employees.Fname', 'FirstName', 'COLUMN';
```


---

####  **ليه مفيش أمر `ALTER TABLE RENAME` في SQL Server؟ مع إنه موجود في لغات تانية زي MySQL ؟**

🔹 لأن SQL Server بيتبع أسلوب مختلف شوية في أوامر التعديل.  
ا  **Microsoft** فضلت تخلي عمليات إعادة التسمية تحصل عن طريق أوامر خاصة (Stored Procedures) زي `sp_rename`.

🔸 لكن لغات تانية زي: **PostgreSQL** - **MySQL**  بيدعمو أوامر مباشرة زي:

```sql
-- ده شغال في PostgreSQL مثلاً:
ALTER TABLE Customers
RENAME COLUMN CustomerName TO FullName;
```


- ودا عشان يحافظوا على التوافق مع إصدارات SQL Server القديمة، ويدقهم تحكم اكبر في العمليات.    




---
---

## 2- امر `DROP` — حذف جدول أو عمود بالكامل


####  `DROP TABLE` — حذف جدول بالكامل

```sql
DROP TABLE Employees;
```


- ده بيمسح **الجدول كله** من قاعدة البيانات، بكل البيانات اللي جواه.  
    ⚠️ **ملوش رجوع**، لازم تتأكد 100% إنك مش محتاجه.
    
---

####  `DROP COLUMN` — حذف عمود من جدول

```sql
ALTER TABLE Employees
DROP COLUMN Department;
```


- ا  `ALTER TABLE Employees`: إحنا بنعدل جدول `Employees`.
    
- ا  `DROP COLUMN Department`: بنحذف العمود اللي اسمه `Department`.


---
---
---


##  أوامر التعديل على البيانات (DML)

###  الأمر `INSERT INTO` 

**ده أمر بنستخدمه علشان نضيف بيانات جديدة لأي جدول عندنا في قاعدة البيانات.**
يعني مثلاً لو عندك جدول اسمه `Employees`، ومحتاج تسجل فيه موظف جديد، فـ `INSERT INTO` هو اللي هيقوم بالمهمة دي.

#### أول نوع: إضافة صف كامل للجدول
يعني هتملى كل الأعمدة اللي موجودة في الجدول، وبترتيب الأعمدة نفسه جوه الجدول.

مثال:
```sql
INSERT INTO Employees  
VALUES('Mariam','Mohammed','F','1995-12-05', NULL, NULL);
```

- ا `INSERT INTO Employees` : يعني إحنا هنضيف بيانات جديدة في الجدول اللي اسمه `Employees`.
    
- ا `VALUES(...)` : القيم اللي هندخلها، ولازم تكون **بنفس ترتيب الأعمدة** في الجدول.
    

يعني لو الأعمدة بتيجي بالترتيب ده:  
`Fname`, `Lname`, `Gender`, `BirthDate`, `Supper_SSN`, `Dept_ID`
فالبيانات اللي هندخلها هتروح كده:

- ا `'Mariam'` ← العمود `Fname`
- ا `'Mohammed'` ← العمود `Lname`
- ا `'F'` ← العمود `Gender`  ، وهكذا

---

##  تاني نوع: إدخال بيانات في أعمدة معينة بس

أحيانًا مش هتحتاج تملى كل الأعمدة، ممكن تحب تسجل بس الاسم والجنس مثلاً، والباقي لسه مش متوفر عندك.

مثال:
```sql
INSERT INTO Employees(Fname, Gender)  
VALUES('Moaz','M');
```


- هنا إحنا بنقول إننا عايزين نضيف بيانات في **عمودين بس** من جدول `Employees`.
- العمودين هما: `Fname`, و `Gender`
- والقيم اللي هندخلها: `'Moaz'` هتروح في `Fname`، و `'M'` في `Gender`.

> باقي الأعمدة هتكون Null  لو مش معمول عليها شرط (NOT NULL) .

---

###  تالت نوع: إدخال أكتر من صف مرة واحدة (Row Constructor)

يعني بدل ما تكتب أمر `INSERT` كل مرة، ممكن تضيف مجموعة صفوف مع بعض.

مثال:
```sql
INSERT INTO Employees(Fname, Lname, Gender, BirthDate, Supper_SSN, Dept_ID)  
VALUES  
('Sama','Khaled','F','2000-10-12',NULL,1),  
('Samy','Sabry','M','1998-10-12',NULL,1),  
('Manar','Ahmed','F','1998-03-12',NULL,1),  
('Mohammed','Amr','M','1995-10-12',NULL,1);
```

- كل صف محطوط بين قوسين، وكل قيمة رايحة في مكانها حسب ترتيب الأعمدة وبنفصل بينهم بفاصلة (`,`)

---
##  ملحوظات مهمة:

1. لو فيه أعمدة عليها شرط `NOT NULL` وممدخلتش فيها قيمة، هيديك خطأ.
    
2. لو عندك مفتاح أساسي (Primary Key) زي رقم الموظف، لازم يكون فريد في كل صف جديد.
    
3. القيم لازم تتماشى مع نوع البيانات بتاع العمود:
    - لو العمود نص، حط القيم بين علامات اقتباس `'...'`
    - لو العمود رقم، مفيش داعي لعلامات الاقتباس
    - لو تاريخ، اكتبه بصيغة `'YYYY-MM-DD'`



---
---



## الامر `UPDATE` — لتعديل البيانات الموجودة

 بنستخدمه لما نكون عايزين **نغيّر بيانات موجودة بالفعل** جوّه الجدول.

الامر:
```sql
UPDATE اسم_الجدول
SET القيمة_الجديدة = اسم_العمود  
WHERE شرط_التعديل;
```

---


 مثال: تعديل مشرف موظف معين
```sql
UPDATE Employees
SET Supper_SSN = 2
WHERE SSN = 4;
```

- `UPDATE Employees` → عدل في جدول الموظفين.
- `SET Supper_SSN = 2` → خلي المشرف رقم 2.
- `WHERE SSN = 4` → بس للموظف اللي رقمه 4.

---

 مثال 2: تغيير اسم العائلة (اللقب)
```sql
UPDATE Employees
SET Lname = 'Ali'
WHERE SSN = 2;
```

---

 مثال 3: زيادة المرتب بنسبة 10٪ للموظفات اللي مرتبهم 5000 أو أقل
```sql
UPDATE Employees
SET Salary = Salary + Salary * 0.1
WHERE Gender = 'F' AND Salary <= 5000;
```

- بنزوّد **المرتب بنسبة 10%**  بس لو كانت **الموظفة** (الجنس = 'F') ومرتبها **5000 أو أقل**.

---

## ثانيًا: `DELETE` — لحذف صفوف من الجدول

بنستخدم الأمر ده لما نكون عايزين **نمحي بيانات موظف أو أكتر** من الجدول.

مثال: 
```sql
DELETE FROM Employees
WHERE SSN = 8;
```

- `DELETE FROM Employees`      → امسح صف من جدول الموظفين.
    
- `WHERE SSN = 8`       → لكن بس امسح الموظف اللي رقمه 8.
- 
⚠️ **لو نسيت تكتب شرط `WHERE`، هيتحذف كل البيانات من الجدول!**



---
---



## الأمر `SELECT` — لجلب البيانات من الجدول

الوظيفة الأساسية للأمر ده هي **عرض البيانات** من قاعدة البيانات. سواء كل البيانات، أو بيانات معينة بشروط.

---

###  عرض كل البيانات من الجدول

```sql
SELECT * FROM Student;
```

  `SELECT *`  => اعرض **كل الأعمدة** من الجدول.
  `FROM Student`  =>  من جدول الطلاب اللي اسمه `Student`.

---

###  عرض أعمدة معينة 

```sql
SELECT St_Fname, St_Lname, St_Age
FROM Student;
```

اعرض **الاسم الأول** و**اسم العائلة** و**العمر** بس لكل طالب.

وهنا أنت بتقلل البيانات المعروضة، وبتشوف بس اللي محتاجه.

---

###  عرض بيانات طالب معين برقم ID

```sql
SELECT St_Id, St_Fname, St_Lname, St_Age
FROM Student
WHERE St_Id = 6;
```

 اعرض بيانات الطالب اللي رقمه 6 فقط.

---
###  فلتره البيانات حسب العمر

```sql
SELECT St_Id, St_Fname, St_Age
FROM Student
WHERE St_Age > 23;
```

 اعرض بس الطلاب اللي عمرهم أكتر من 23.

---

###  الطلاب اللي أعمارهم **بين 23 و 30** سنة

```sql
WHERE St_Age BETWEEN 23 AND 30;
```

 "BETWEEN" معناها: من 23 **لحد** 30، وبتشمل الرقمين.

 نفس النتيجة ممكن نكتبها كده:

```sql
WHERE St_Age >= 23 AND St_Age <= 30;
```

---

### ❌ الطلاب اللي أعمارهم **مش** بين 23 و30

```sql
WHERE St_Age NOT BETWEEN 23 AND 30;
```

 دي بتعرض كل الطلاب اللي عمرهم أقل من 23 أو أكبر من 30.

---

##  البحث حسب العنوان (Address)

####  طلاب ساكنين في "القاهرة" أو "الإسكندرية"

```sql
WHERE St_Address IN ('cairo', 'Alex');
```

 `IN` معناها: أي واحد من اللي في القوسين.

---

#### ❌ طلاب مش ساكنين في "القاهرة" ولا "الإسكندرية"

```sql
WHERE St_Address NOT IN ('cairo', 'Alex');
```

 "NOT IN" بتعني العكس تمامًا.

---

##  استخدام NULL

####  الطلاب اللي **ما عندهمش مشرف**

```sql
WHERE St_super IS NULL;
```

🔸 `IS NULL`  
يعني العمود فاضي، أو **مافيش قيمة خالص** فيه.

---

###  الطلاب اللي **عندهم مشرف**

```sql
WHERE St_super IS NOT NULL;
```

🔸 `IS NOT NULL`  
يعني: فيه قيمة موجودة.

---

### ❌ نفي شرط باستخدام `NOT`

```sql
WHERE NOT (St_Age > 25);
```

 يعني: اعرض كل اللي عمرهم **25 أو أقل**.

---

### ❌ استخدام علامة "لا يساوي"

```sql
WHERE St_Age <> 30;
```

🔸 `<>` معناها: **مش بيساوي**.

---

###  استخدام شرط بديل باستخدام `OR`

```sql
WHERE St_Address = 'cairo' OR St_Address = 'Alex';
```

 دي معناها: اعرض الطلاب اللي ساكنين في القاهرة **أو** الإسكندرية.



---
___

ملاحظات اضافيه:  


#### لو عايز تعرض **أول 5 صفوف فقط** من جدول فيه بيانات كتير:

```sql
SELECT TOP 5 * FROM Student;
```


- `SELECT TOP 5` →   "هات أول 5 صفوف بس".
- `FROM Student` → من جدول الطلاب.
    
 لو عايز **تعرض عينة بسيطة من البيانات** بدل ما تطبع كل الصفوف.



----

####  `ORDER BY` —    ترتيب نتائج الاستعلامات

بنستخدمه علشان نرتّب البيانات حسب عمود أو أكتر.

 تصاعدي (من الصغير للكبير):
```sql
SELECT * FROM Student
ORDER BY St_Age ASC;
```

 تنازلي (من الكبير للصغير):
```sql
SELECT * FROM Student
ORDER BY St_Age DESC;
```

 ترتيب حسب أكتر من عمود:
```sql
ORDER BY St_Address ASC, St_Age DESC;
```

---

